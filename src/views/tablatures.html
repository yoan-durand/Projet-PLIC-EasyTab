
{% extends 'layout.html' %}

{% block title %}Home Page{% endblock %}

{% block head %}
<link rel="stylesheet" href="css/smoothness/jquery-ui-1.8.18.custom.css" />
<link rel="stylesheet" href="css/site.css">
<script src="js/jquery-1.7.1.js"></script>
<script src="js/jquery-ui-1.8.18.custom.min.js"></script>
<script type="text/javascript">
	function search(recherche) {
		$.post('/search/'+recherche, function(data, textStatus) {
			$('#trackList').empty();
			for (var i = 0; i < data.length; ++i) {
				$('#trackList').append('<li> <a href="application;'+data[i].nom+'.xml">'+data[i].nom
					+'</a> <span id="trackInfos">'+data[i].titre+' - '+data[i].artiste+'</span></li>')
			}
		}, 'json');
	}
	$(function(){
		$('#uploadLink > button').button();
		$('#trackList > li').dblclick(function(e){
			location.href = $('a', this).attr('href');
		});
		$('#searchForm > input').keyup(function(e){
			if (e.which == 27) {
				$(this).val('');
				search('');
			}
		});
		$('#searchForm').submit(function(e){
			e.preventDefault();
			var recherche = $('input', this).val();
			search(recherche);
		});
	});
</script>
{% endblock %}

{% block content %}
<section id="container" class="center">
	<div>
		<form id="searchForm">
			<input id="searchBox" placeholder="Rechercher...">
		</form>
		<p>
			<a href="upload" id="uploadLink">Ajouter une tablature <button>+</button></a>
		</p>
	</div>
	<div>
		<ul id="trackList">
			{% for xml in pistes -%}
			<li>
				<a href="application;{{ xml.nom }}.xml">{{ xml.nom }}</a> <span id="trackInfos">{{xml.titre}} - {{xml.artiste}}</span>
			</li>
			{%- endfor %}
		</ul>
	</div>
</section>
{% endblock %}